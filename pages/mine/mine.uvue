<template>
  <view class="container">
    <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
    <view class="user-header">
      <view class="user-avatar">
        <text class="avatar-icon">ğŸ‘¤</text>
      </view>
      <view class="user-info">
        <text class="user-name">{{ userInfo.nickname }}</text>
        <text class="user-id">ID: {{ userInfo.userId }}</text>
      </view>
    </view>

    <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
    <view class="info-section">
      <text class="section-title">ä¸ªäººä¿¡æ¯</text>
      <view class="info-list">
        <view class="info-item" @click="editGender">
          <view class="info-left">
            <text class="info-icon">ğŸš»</text>
            <text class="info-label">æ€§åˆ«</text>
          </view>
          <view class="info-right">
            <text class="info-value">{{ userInfo.gender }}</text>
            <text class="info-arrow">></text>
          </view>
        </view>
        
        <view class="info-item" @click="editBirthday">
          <view class="info-left">
            <text class="info-icon">ğŸ‚</text>
            <text class="info-label">ç”Ÿæ—¥</text>
          </view>
          <view class="info-right">
            <text class="info-value">{{ userInfo.birthday }}</text>
            <text class="info-arrow">></text>
          </view>
        </view>
        
        <view class="info-item">
          <view class="info-left">
            <text class="info-icon">ğŸ“±</text>
            <text class="info-label">æ‰‹æœºå·</text>
          </view>
          <view class="info-right">
            <text class="info-value">{{ userInfo.phone }}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- è®¾ç½®é€‰é¡¹ -->
    <view class="settings-section">
      <text class="section-title">è®¾ç½®</text>
      <view class="settings-list">
        <view class="settings-item" @click="showAbout">
          <view class="settings-left">
            <text class="settings-icon">â„¹ï¸</text>
            <text class="settings-label">å…³äºæˆ‘ä»¬</text>
          </view>
          <text class="settings-arrow">></text>
        </view>
        
        <view class="settings-item" @click="showFeedback">
          <view class="settings-left">
            <text class="settings-icon">ğŸ’¬</text>
            <text class="settings-label">æ„è§åé¦ˆ</text>
          </view>
          <text class="settings-arrow">></text>
        </view>
        
        <view class="settings-item" @click="logout">
          <view class="settings-left">
            <text class="settings-icon">ğŸšª</text>
            <text class="settings-label">é€€å‡ºç™»å½•</text>
          </view>
          <text class="settings-arrow">></text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨tabæ  -->
    <view class="bottom-tab-bar">
      <view class="tab-item" :class="{ active: currentTab === 'health' }" @click="switchTab('health')">
        <text class="tab-icon">ğŸ¥</text>
        <text class="tab-text">å¥åº·</text>
      </view>
      <view class="tab-item" :class="{ active: currentTab === 'chat' }" @click="switchTab('chat')">
        <text class="tab-icon">ğŸ’¬</text>
        <text class="tab-text">é—®AI</text>
      </view>
      <view class="tab-item" :class="{ active: currentTab === 'mine' }" @click="switchTab('mine')">
        <text class="tab-icon">ğŸ‘¤</text>
        <text class="tab-text">æˆ‘çš„</text>
      </view>
    </view>
  </view>
</template>

<script setup>
import { ref } from 'vue'

// å½“å‰é€‰ä¸­çš„tab
const currentTab = ref('mine')

// ç”¨æˆ·ä¿¡æ¯
const userInfo = ref({
  nickname: 'å¥åº·ç”¨æˆ·',
  userId: '12345678',
  gender: 'ç”·',
  birthday: '1990-01-01',
  phone: '138****8888'
})

// åˆ‡æ¢tab
const switchTab = (tab) => {
  currentTab.value = tab
  if (tab === 'health') {
    uni.redirectTo({
      url: '/pages/index/index'
    })
  } else if (tab === 'chat') {
    uni.redirectTo({
      url: '/pages/chat/chat'
    })
  }
}

// ç¼–è¾‘æ€§åˆ«
const editGender = () => {
  uni.showActionSheet({
    itemList: ['ç”·', 'å¥³'],
    success: (res) => {
      userInfo.value.gender = res.tapIndex === 0 ? 'ç”·' : 'å¥³'
    }
  })
}

// ç¼–è¾‘ç”Ÿæ—¥
const editBirthday = () => {
  uni.showDatePicker({
    currentDate: userInfo.value.birthday,
    success: (res) => {
      const date = new Date(res.year, res.month - 1, res.day)
      userInfo.value.birthday = date.toISOString().split('T')[0]
    }
  })
}

// æ˜¾ç¤ºå…³äºæˆ‘ä»¬
const showAbout = () => {
  uni.showModal({
    title: 'å…³äºæˆ‘ä»¬',
    content: 'WellMateå¥åº·åŠ©æ‰‹\nç‰ˆæœ¬ï¼š1.0.0\nè‡´åŠ›äºæ‚¨çš„å¥åº·ç”Ÿæ´»',
    showCancel: false
  })
}

// æ˜¾ç¤ºæ„è§åé¦ˆ
const showFeedback = () => {
  uni.showModal({
    title: 'æ„è§åé¦ˆ',
    content: 'å¦‚æœ‰ä»»ä½•å»ºè®®æˆ–é—®é¢˜ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼š\né‚®ç®±ï¼šfeedback@wellmate.com',
    showCancel: false
  })
}

// é€€å‡ºç™»å½•
const logout = () => {
  uni.showModal({
    title: 'ç¡®è®¤é€€å‡º',
    content: 'ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ',
    success: (res) => {
      if (res.confirm) {
        uni.showToast({
          title: 'å·²é€€å‡ºç™»å½•',
          icon: 'success'
        })
        // å®é™…åº”ç”¨ä¸­è¿™é‡Œåº”è¯¥æ¸…é™¤ç™»å½•çŠ¶æ€å¹¶è·³è½¬åˆ°ç™»å½•é¡µ
      }
    }
  })
}
</script>

<style scoped>
.container {
  padding: 40rpx 30rpx 120rpx 30rpx;
  background: #f8f9fa;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
}

/* é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯ */
.user-header {
  display: flex;
  align-items: center;
  padding: 40rpx 0;
  border-bottom: 1rpx solid #e9ecef;
  margin-bottom: 40rpx;
}

.user-avatar {
  width: 120rpx;
  height: 120rpx;
  border-radius: 50%;
  background: #3498db;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 30rpx;
}

.avatar-icon {
  font-size: 60rpx;
}

.user-info {
  flex: 1;
}

.user-name {
  font-size: 48rpx;
  font-weight: bold;
  color: #2c3e50;
  display: block;
  margin-bottom: 10rpx;
}

.user-id {
  font-size: 28rpx;
  color: #7f8c8d;
  display: block;
}

/* ä¸ªäººä¿¡æ¯åŒºåŸŸ */
.info-section {
  margin-bottom: 40rpx;
}

.section-title {
  font-size: 32rpx;
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 30rpx;
  display: block;
}

.info-list {
  background: #ffffff;
  border-radius: 16rpx;
  overflow: hidden;
  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);
}

.info-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 30rpx 25rpx;
  border-bottom: 1rpx solid #f1f2f6;
  transition: all 0.3s ease;
}

.info-item:last-child {
  border-bottom: none;
}

.info-item:active {
  background: #f8f9fa;
}

.info-left {
  display: flex;
  align-items: center;
}

.info-icon {
  font-size: 36rpx;
  margin-right: 20rpx;
  width: 40rpx;
  text-align: center;
}

.info-label {
  font-size: 32rpx;
  color: #2c3e50;
}

.info-right {
  display: flex;
  align-items: center;
}

.info-value {
  font-size: 32rpx;
  color: #7f8c8d;
  margin-right: 15rpx;
}

.info-arrow {
  font-size: 28rpx;
  color: #bdc3c7;
  font-weight: bold;
}

/* è®¾ç½®åŒºåŸŸ */
.settings-section {
  margin-bottom: 40rpx;
}

.settings-list {
  background: #ffffff;
  border-radius: 16rpx;
  overflow: hidden;
  box-shadow: 0 2rpx 12rpx rgba(0, 0, 0, 0.08);
}

.settings-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 30rpx 25rpx;
  border-bottom: 1rpx solid #f1f2f6;
  transition: all 0.3s ease;
}

.settings-item:last-child {
  border-bottom: none;
}

.settings-item:active {
  background: #f8f9fa;
}

.settings-left {
  display: flex;
  align-items: center;
}

.settings-icon {
  font-size: 36rpx;
  margin-right: 20rpx;
  width: 40rpx;
  text-align: center;
}

.settings-label {
  font-size: 32rpx;
  color: #2c3e50;
}

.settings-arrow {
  font-size: 28rpx;
  color: #bdc3c7;
  font-weight: bold;
}

/* åº•éƒ¨æ‚¬æµ®tabæ  */
.bottom-tab-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  background: white;
  display: flex;
  height: 100rpx;
  border-top: 1rpx solid #e9ecef;
  box-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.1);
  z-index: 1000;
}

.tab-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 15rpx 0;
  transition: all 0.3s ease;
}

.tab-item.active {
  color: #3498db;
}

.tab-item.active .tab-icon {
  color: #3498db;
}

.tab-item.active .tab-text {
  color: #3498db;
}

.tab-icon {
  font-size: 36rpx;
  margin-bottom: 8rpx;
  color: #95a5a6;
}

.tab-text {
  font-size: 22rpx;
  color: #95a5a6;
}
</style>